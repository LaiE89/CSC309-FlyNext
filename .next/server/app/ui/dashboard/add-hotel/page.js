(()=>{var e={};e.id=4129,e.ids=[4129],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},48376:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>i.a,__next_app__:()=>c,pages:()=>u,routeModule:()=>p,tree:()=>n});var a=r(65239),s=r(48088),o=r(88170),i=r.n(o),l=r(30893),d={};for(let e in l)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);r.d(t,d);let n={children:["",{children:["ui",{children:["dashboard",{children:["add-hotel",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,61512)),"/app/app/ui/dashboard/add-hotel/page.js"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,13376)),"/app/app/ui/dashboard/layout.js"]}]},{metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,46055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(r.bind(r,32648)),"/app/app/layout.js"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"],metadata:{icon:[async e=>(await Promise.resolve().then(r.bind(r,46055))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]}.children,u=["/app/app/ui/dashboard/add-hotel/page.js"],c={require:r,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:s.RouteKind.APP_PAGE,page:"/ui/dashboard/add-hotel/page",pathname:"/ui/dashboard/add-hotel",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:n}})},55511:e=>{"use strict";e.exports=require("crypto")},61512:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>a});let a=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"/app/app/ui/dashboard/add-hotel/page.js\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"/app/app/ui/dashboard/add-hotel/page.js","default")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},63640:(e,t,r)=>{Promise.resolve().then(r.bind(r,61512))},70798:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>d});var a=r(60687),s=r(43210),o=r(62844),i=r(16189),l=r(21092);function d(){let e=(0,i.useRouter)(),{theme:t}=(0,l.D)(),[r,d]=(0,s.useState)(""),[n,u]=(0,s.useState)(""),[c,p]=(0,s.useState)(""),[h,x]=(0,s.useState)(""),[b,g]=(0,s.useState)(1),[m,y]=(0,s.useState)([]),[f,w]=(0,s.useState)(null),[v,k]=(0,s.useState)(!1),[j,N]=(0,s.useState)(""),[$,S]=(0,s.useState)(""),[P,C]=(0,s.useState)([]),[q,_]=(0,s.useState)([]),A=(e,t)=>{let r=e.target.files;r&&("images"===t?y([...m,...Array.from(r)]):w(r[0]))},E=e=>{y(m.filter((t,r)=>r!==e))},R=async e=>{try{let t=new URLSearchParams({query:e}).toString(),r=await fetch(`/api/visitor/cities?${t}`);if(!r.ok)throw Error("Failed to fetch city suggestions");let a=await r.json();C(a.suggestions)}catch(e){console.error(e.message)}},H=async e=>{try{let t=new URLSearchParams({query:e}).toString(),r=await fetch(`/api/visitor/countries?${t}`);if(!r.ok)throw Error("Failed to fetch country suggestions");let a=await r.json();_(a.suggestions)}catch(e){console.error(e.message)}},O=e=>{p(e),C([])},T=e=>{x(e),_([])},G=async t=>{t.preventDefault(),k(!0),N(""),S("");try{let t=null,a=[],s={name:r,address:n,city:c,country:h,starRating:b,logo:t,images:a},i=await (0,o.v$)("/api/user/add-hotel",{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)}),l=await i.json();if(!i.ok)throw 440===i.status&&e.push("/ui/error/session-expired"),Error(l.error);if(f){let r=new FormData;r.append("file",f),r.append("upload-type","hotel-image"),r.append("hotel-id",l.hotel.id);let a=await (0,o.v$)("/api/upload",{method:"POST",credentials:"include",body:r}),s=await a.json();if(!a.ok)throw 440===a.status&&e.push("/ui/error/session-expired"),Error(s.error);t=s.url}for(let t of m){let r=new FormData;r.append("file",t),r.append("upload-type","hotel-image"),r.append("hotel-id",l.hotel.id);let s=await (0,o.v$)("/api/upload",{method:"POST",credentials:"include",body:r}),i=await s.json();if(!s.ok)throw 440===s.status&&e.push("/ui/error/session-expired"),Error(i.error);a.push(i.url)}i=await (0,o.v$)("/api/user/add-hotel",{method:"PATCH",body:JSON.stringify({id:l.hotel.id,images:a,logo:t})});let v=await i.json();if(!i.ok)throw 440===i.status&&e.push("/ui/error/session-expired"),Error(v.error);l.isRoleChanged?(S("Hotel added successfully! Role has been changed so redirecting to login..."),setTimeout(()=>e.push("/ui/login"),2e3)):S("Hotel added successfully!"),d(""),u(""),p(""),x(""),g(1),y([]),w(null)}catch(e){N(e.message||"An unexpected error occurred.")}finally{k(!1)}};return(0,a.jsxs)("div",{className:`max-w-md mx-auto mt-10 shadow-md rounded-2xl p-6 text-center space-y-6 ${"dark"===t?"bg-gray-800 text-white":"bg-white text-gray-800"}`,children:[(0,a.jsx)("h2",{className:`text-2xl font-bold mb-4 ${"dark"===t?"text-white":"text-black"}`,children:"Add a New Hotel"}),(0,a.jsxs)("form",{onSubmit:G,className:"space-y-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:`block text-sm font-medium ${"dark"===t?"text-white":"text-black"}`,children:"Hotel Name"}),(0,a.jsx)("input",{type:"text",value:r,onChange:e=>d(e.target.value),required:!0,className:`w-full p-2 border rounded ${"dark"===t?"bg-gray-700 text-white border-gray-600":"bg-white text-black border-gray-300"}`})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:`block text-sm font-medium ${"dark"===t?"text-white":"text-black"}`,children:"Address"}),(0,a.jsx)("input",{type:"text",value:n,onChange:e=>u(e.target.value),required:!0,className:`w-full p-2 border rounded ${"dark"===t?"bg-gray-700 text-white border-gray-600":"bg-white text-black border-gray-300"}`})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:`block text-sm font-medium ${"dark"===t?"text-white":"text-black"}`,children:"City"}),(0,a.jsxs)("div",{className:"relative w-full",children:[(0,a.jsx)("input",{type:"text",value:c,onChange:e=>{let t=e.target.value;p(t),""!=t?R(t):C([])},required:!0,className:`w-full p-2 border rounded ${"dark"===t?"bg-gray-700 text-white border-gray-600":"bg-white text-black border-gray-300"}`}),P.length>0&&(0,a.jsx)("ul",{className:`absolute top-full left-0 right-0 border overflow-y-auto z-10 list-none rounded shadow-md 
                                ${"dark"===t?"bg-gray-800 border-gray-600":"bg-white border-gray-300"}`,children:P.map((e,r)=>(0,a.jsx)("li",{onClick:()=>O(e),className:`p-2 cursor-pointer hover:bg-gray-100 ${"dark"===t?"hover:bg-gray-700":"hover:bg-gray-100"}`,children:e},r))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:`block text-sm font-medium ${"dark"===t?"text-white":"text-black"}`,children:"Country"}),(0,a.jsxs)("div",{className:"relative w-full",children:[(0,a.jsx)("input",{type:"text",value:h,onChange:e=>{let t=e.target.value;x(t),""!=t?H(t):_([])},required:!0,className:`w-full p-2 border rounded ${"dark"===t?"bg-gray-700 text-white border-gray-600":"bg-white text-black border-gray-300"}`}),q.length>0&&(0,a.jsx)("ul",{className:`absolute top-full left-0 right-0 border overflow-y-auto z-10 list-none rounded shadow-md 
                                ${"dark"===t?"bg-gray-800 border-gray-600":"bg-white border-gray-300"}`,children:q.map((e,r)=>(0,a.jsx)("li",{onClick:()=>T(e),className:`p-2 cursor-pointer hover:bg-gray-100 ${"dark"===t?"hover:bg-gray-700":"hover:bg-gray-100"}`,children:e},r))})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:`block text-sm font-medium ${"dark"===t?"text-white":"text-black"}`,children:"Star Rating"}),(0,a.jsx)("select",{value:b,onChange:e=>g(Number(e.target.value)),className:`w-full p-2 border rounded ${"dark"===t?"bg-gray-700 text-white border-gray-600":"bg-white text-black border-gray-300"}`,children:[1,2,3,4,5].map(e=>(0,a.jsxs)("option",{value:e,children:[e," Star",1!==e?"s":""]},e))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:`block text-sm font-medium ${"dark"===t?"text-white":"text-black"}`,children:"Hotel Images (Optional)"}),(0,a.jsx)("input",{type:"file",accept:"image/*",multiple:!0,onChange:e=>A(e,"images"),className:`w-full p-2 border rounded ${"dark"===t?"bg-gray-700 text-white border-gray-600":"bg-white text-black border-gray-300"}`}),m.length>0&&(0,a.jsx)("div",{className:"mt-2 space-y-1",children:m.map((e,r)=>(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("p",{className:`text-sm truncate ${"dark"===t?"text-white":"text-black"}`,children:e.name}),(0,a.jsx)("button",{type:"button",onClick:()=>E(r),className:"text-red-500 text-sm hover:underline",children:"Remove"})]},r))})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("label",{className:`block text-sm font-medium ${"dark"===t?"text-white":"text-black"}`,children:"Hotel Logo (Optional)"}),(0,a.jsx)("input",{type:"file",accept:"image/*",onChange:e=>A(e,"logo"),className:`w-full p-2 border rounded ${"dark"===t?"bg-gray-700 text-white border-gray-600":"bg-white text-black border-gray-300"}`}),f&&(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)("p",{className:`text-sm truncate ${"dark"===t?"text-white":"text-black"}`,children:f.name}),(0,a.jsx)("button",{type:"button",onClick:()=>{w(null)},className:"text-red-500 text-sm hover:underline",children:"Remove"})]})]}),(0,a.jsx)("button",{type:"submit",disabled:v,className:"w-full bg-blue-500 text-white py-2 px-4 rounded hover:bg-blue-600",children:v?"Submitting...":"Add Hotel"})]}),j&&(0,a.jsx)("div",{className:`p-4 rounded-lg ${"dark"===t?"bg-red-900/50":"bg-red-100"}`,children:(0,a.jsx)("p",{className:"text-red-500",children:j})}),$&&(0,a.jsx)("div",{className:`p-4 rounded-lg ${"dark"===t?"bg-green-900/50":"bg-green-100"}`,children:(0,a.jsx)("p",{className:"text-green-500",children:$})})]})}},73368:(e,t,r)=>{Promise.resolve().then(r.bind(r,70798))},79428:e=>{"use strict";e.exports=require("buffer")},79551:e=>{"use strict";e.exports=require("url")}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[7719,1179,1658,2142,1026],()=>r(48376));module.exports=a})();