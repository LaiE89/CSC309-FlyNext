(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6654],{2919:(e,t,s)=>{Promise.resolve().then(s.bind(s,8497))},5550:(e,t,s)=>{"use strict";s.d(t,{D:()=>o,N:()=>l});var r=s(5155),i=s(2115);let n=(0,i.createContext)();function l(e){let{children:t}=e,[s,l]=(0,i.useState)("dark"),[o,c]=(0,i.useState)(!1);return((0,i.useEffect)(()=>{c(!0)},[]),o)?(0,r.jsx)(n.Provider,{value:{theme:s,toggleTheme:()=>{l("dark"===s?"light":"dark")}},children:t}):null}function o(){let e=(0,i.useContext)(n);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e}},8497:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>c});var r=s(5155),i=s(2115),n=s(5695),l=s(5550),o=s(9292);function c(){let e=(0,n.useRouter)(),{theme:t}=(0,l.D)(),[s,c]=(0,i.useState)(""),[a,d]=(0,i.useState)(!0),[h,x]=(0,i.useState)(null),u=localStorage.getItem("currentBookingId"),g=u?parseInt(u,10):null,m=async()=>{if(d(!0),null==g){d(!1);return}try{let t=await (0,o.v$)("/api/user/booking/retrieve?bookingId=".concat(g),{method:"GET",credentials:"include"}),s=await t.json();if(!t.ok)throw 440===t.status&&e.push("/ui/error/session-expired"),Error(s.error);x(s)}catch(e){c(e.message||"An unexpected error occurred.")}finally{d(!1)}};return((0,i.useEffect)(()=>{m()},[]),a)?(0,r.jsx)("div",{className:"flex justify-center items-center h-64 ".concat("dark"===t?"text-white":"text-gray-800"),children:(0,r.jsx)("div",{className:"text-lg font-medium animate-pulse",children:"Loading..."})}):s?(0,r.jsx)("div",{className:"flex justify-center items-center h-64 ".concat("dark"===t?"text-white":"text-gray-800"),children:(0,r.jsxs)("div",{className:"px-6 py-4 rounded-md shadow-md bg-white",children:[(0,r.jsx)("p",{className:"font-semibold text-red-500",children:"Error:"}),(0,r.jsx)("p",{className:"text-red-500",children:s}),(0,r.jsx)("button",{onClick:()=>{localStorage.clear(),e.back()},className:"hover:underline cursor-pointer mt-2 text-red-500",children:"Go Back"})]})}):h?(0,r.jsxs)("div",{className:"p-5 text-center ".concat("dark"===t?"text-white":"text-gray-800"),children:[(0,r.jsxs)("h1",{className:"text-2xl font-bold mb-4",children:["Current Booking: ID ",g||"N/A"]}),(0,r.jsxs)("div",{className:"space-y-6",children:[h.flight&&(0,r.jsxs)("div",{className:"border-b pb-4",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold mb-2",children:"Flight Details"}),Array.isArray(h.flight.flights)?h.flight.flights.map((e,t)=>(0,r.jsxs)("div",{className:"mb-4 p-4 rounded",children:[(0,r.jsx)("p",{children:(0,r.jsxs)("strong",{children:["Flight ",t+1,":"]})}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Flight Number:"})," ",e.flightNumber]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Airline:"})," ",e.airline]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"From:"})," ",e.origin]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"To:"})," ",e.destination]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Departure:"})," ",new Date(e.departureTime).toLocaleString()]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Arrival:"})," ",new Date(e.arrivalTime).toLocaleString()]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Status:"})," ",e.status]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Price:"})," $",e.price]})]},t)):(0,r.jsxs)("div",{className:"p-4 rounded",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Flight Number:"})," ",h.flight.flightNumber]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Airline:"})," ",h.flight.airline]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"From:"})," ",h.flight.origin]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"To:"})," ",h.flight.destination]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Departure:"})," ",new Date(h.flight.departureTime).toLocaleString()]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Arrival:"})," ",new Date(h.flight.arrivalTime).toLocaleString()]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Status:"})," ",h.flight.status]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Price:"})," $",h.flight.price]})]})]}),h.hotel&&(0,r.jsxs)("div",{className:"border-b pb-4",children:[(0,r.jsx)("h2",{className:"text-2xl font-semibold mb-2",children:"Hotel Details"}),(0,r.jsxs)("div",{className:"p-4 rounded",children:[(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Hotel:"})," ",h.hotel.name]}),(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Location:"})," ",h.hotel.city]}),h.booking.checkIn&&(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Check-in:"})," ",new Date(h.booking.checkIn).toLocaleDateString()]}),h.booking.checkOut&&(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Check-out:"})," ",new Date(h.booking.checkOut).toLocaleDateString()]}),h.room.type&&(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Room Type:"})," ",h.room.type]}),h.room.pricePerNight&&(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Room Type:"})," ",h.room.pricePerNight]}),h.nightsStayed&&(0,r.jsxs)("p",{children:[(0,r.jsx)("strong",{children:"Nights Stayed:"})," ",h.nightsStayed]})]})]}),(0,r.jsx)("div",{className:"pt-4 pb-4",children:(0,r.jsxs)("div",{className:"flex justify-between items-center",children:[(0,r.jsx)("p",{className:"text-2xl font-semibold",children:"Total Amount"}),(0,r.jsxs)("p",{className:"text-xl font-bold",children:["$",h.price?h.price:0]})]})})]}),g&&(0,r.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 w-full max-w-4xl mx-auto",children:[(0,r.jsx)("button",{onClick:()=>{h.hotel?e.push("/ui/dashboard/flights?location=".concat(encodeURIComponent(h.hotel.city))):e.push("/ui/dashboard/flights")},className:"w-full h-14 bg-blue-600 text-white font-medium rounded-xl hover:bg-blue-700 transition-colors shadow-sm",children:"Flight Suggestions"}),(0,r.jsx)("button",{onClick:()=>{if(h.mainDestination){let t=new URLSearchParams;t.append("city",h.mainDestination),e.push("/ui/dashboard/all-hotels?".concat(t.toString()))}else e.push("/ui/dashboard/all-hotels")},className:"w-full h-14 bg-yellow-500 text-white font-medium rounded-xl hover:bg-yellow-600 transition-colors shadow-sm",children:"Hotel Suggestions"}),(0,r.jsx)("button",{onClick:()=>{localStorage.clear(),g=null,x(null)},className:"w-full h-14 bg-red-600 text-white font-medium rounded-xl hover:bg-red-700 transition-colors shadow-sm",children:"Stop Booking"}),(0,r.jsx)("button",{onClick:()=>{e.push("/ui/dashboard/checkout?bookingId=".concat(g))},className:"w-full h-14 bg-green-600 text-white font-semibold rounded-xl hover:bg-green-700 transition-colors shadow-md",children:"Checkout"})]})]}):(0,r.jsx)("div",{className:"flex justify-center items-center h-64 ".concat("dark"===t?"text-white":"text-gray-800"),children:(0,r.jsx)("div",{className:"text-lg font-medium",children:"No booking in progress"})})}},9292:(e,t,s)=>{"use strict";s.d(t,{v$:()=>i}),s(8801),s(9980);var r=s(9509);async function i(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},s=await fetch(e,{...t,credentials:"include"});if(401===s.status||403===s.status){if(!await n())return new Response(JSON.stringify({message:"Session expired"}),{status:440,headers:{"Content-Type":"application/json"}});s=await fetch(e,{...t,credentials:"include"})}return s}r.env.ACCESS_SECRET,r.env.REFRESH_SECRET,r.env.ACCESS_TOKEN_EXPIRY,r.env.REFRESH_TOKEN_EXPIRY,parseInt(r.env.SALT_ROUNDS,10);async function n(){try{if(!(await fetch("/api/auth/refresh",{method:"POST",credentials:"include"})).ok)return!1;return!0}catch(e){return!1}}},9825:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[9268,3877,8441,1684,7358],()=>t(2919)),_N_E=e.O()}]);