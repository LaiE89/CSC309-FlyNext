(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1880],{3395:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>n});var r=a(5155),s=a(2115),c=a(5695),l=a(9292),d=a(5550);function n(){let{id:e}=(0,c.useParams)(),t=(0,c.useRouter)(),{theme:a}=(0,d.D)(),[n,o]=(0,s.useState)([]),[i,x]=(0,s.useState)([]),[h,m]=(0,s.useState)(!0),[g,u]=(0,s.useState)(""),[y,b]=(0,s.useState)(""),[p,k]=(0,s.useState)({startDate:"",endDate:"",roomType:""});(0,s.useEffect)(()=>{f()},[]);let f=async()=>{m(!0);try{let a=new URLSearchParams(p),r=await (0,l.v$)("/api/hotel-owner/my-hotels/".concat(e,"/bookings?").concat(a),{method:"GET",credentials:"include"}),s=await r.json();if(!r.ok)throw 440===r.status&&t.push("/ui/error/session-expired"),Error(s.error);o(s.bookings),x(s.roomAvailability||[])}catch(e){u(e.message||"An error occurred.")}finally{m(!1)}},N=e=>{let{name:t,value:a}=e.target;k(e=>({...e,[t]:a}))},j=async(a,r)=>{if(confirm("Are you sure you want to delete this booking?"))try{let s=await (0,l.v$)("/api/hotel-owner/my-hotels/".concat(e,"/bookings/").concat(a),{method:"DELETE",credentials:"include"}),c=await s.json();if(!s.ok)throw 440===s.status&&t.push("/ui/error/session-expired"),Error(c.error);o(e=>e.filter(e=>e.id!==a)),x(e=>e.map(e=>e.type===r?{...e,available:e.available+1}:e)),b("Booking deleted successfully!")}catch(e){u(e.message||"An error occurred.")}};return h?(0,r.jsx)("div",{className:"flex justify-center items-center h-64 ".concat("dark"===a?"text-white":"text-gray-800"),children:(0,r.jsx)("div",{className:"text-lg font-medium animate-pulse",children:"Loading..."})}):(0,r.jsxs)("div",{className:"max-w-5xl mx-auto p-6 rounded-2xl shadow-lg space-y-6 ".concat("dark"===a?"bg-gray-800 text-white":"bg-white text-gray-800"),children:[(0,r.jsx)("h2",{className:"text-3xl font-bold ".concat("dark"===a?"text-white":"text-black"),children:"Hotel Bookings"}),(0,r.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 md:grid-cols-4 gap-4",children:[(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("label",{htmlFor:"startDate",className:"text-sm font-medium mb-1 ".concat("dark"===a?"text-gray-300":"text-gray-800"),children:"Check-in Date"}),(0,r.jsx)("input",{type:"date",id:"startDate",name:"startDate",value:p.startDate,onChange:N,className:"border rounded-lg p-2 ".concat("dark"===a?"bg-gray-700 border-gray-600 text-white":"border-gray-300 text-black")})]}),(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("label",{htmlFor:"endDate",className:"text-sm font-medium mb-1 ".concat("dark"===a?"text-gray-300":"text-gray-800"),children:"Check-out date"}),(0,r.jsx)("input",{type:"date",id:"endDate",name:"endDate",value:p.endDate,onChange:N,className:"border rounded-lg p-2 ".concat("dark"===a?"bg-gray-700 border-gray-600 text-white":"border-gray-300 text-black")})]}),(0,r.jsxs)("div",{className:"flex flex-col",children:[(0,r.jsx)("label",{htmlFor:"roomType",className:"text-sm font-medium mb-1 ".concat("dark"===a?"text-gray-300":"text-gray-800"),children:"Room Type"}),(0,r.jsx)("input",{type:"text",id:"roomType",name:"roomType",value:p.roomType,onChange:N,placeholder:"Room Type",className:"border rounded-lg p-2 ".concat("dark"===a?"bg-gray-700 border-gray-600 text-white":"border-gray-300 text-black")})]}),(0,r.jsx)("div",{className:"flex items-end",children:(0,r.jsx)("button",{onClick:f,className:"w-full px-4 py-2 rounded-lg transition ".concat("dark"===a?"bg-blue-600 hover:bg-blue-700 text-white":"bg-blue-500 hover:bg-blue-600 text-white"),children:"Apply Filters"})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-xl font-semibold mb-2 ".concat("dark"===a?"text-white":"text-black"),children:"Room Availability"}),(0,r.jsx)("div",{className:"overflow-x-auto rounded-lg border ".concat("dark"===a?"border-gray-600":"border-gray-200"),children:(0,r.jsxs)("table",{className:"table-fixed w-full text-sm text-sm ".concat("dark"===a?"text-gray-300":"text-gray-700"),children:[(0,r.jsx)("thead",{className:"dark"===a?"bg-gray-700":"bg-gray-100",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"w-1/2 px-4 py-2 text-left font-medium ".concat("dark"===a?"text-white":"text-black"),children:"Room Type"}),(0,r.jsx)("th",{className:"w-1/2 px-4 py-2 text-left font-medium ".concat("dark"===a?"text-white":"text-black"),children:"Number of Available Rooms"})]})}),(0,r.jsx)("tbody",{className:"divide-y",children:i.length>0?i.map(e=>(0,r.jsxs)("tr",{className:"dark"===a?"hover:bg-gray-700":"hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"px-4 py-2 ".concat("dark"===a?"text-gray-300":"text-black"),children:e.type}),(0,r.jsx)("td",{className:"px-4 py-2 ".concat("dark"===a?"text-gray-300":"text-black"),children:e.available})]},e.type)):(0,r.jsx)("tr",{children:(0,r.jsx)("td",{colSpan:2,className:"px-4 py-2 text-center ".concat("dark"===a?"text-gray-300":"text-black"),children:"No available rooms found."})})})]})})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("h3",{className:"text-xl font-semibold mb-2 ".concat("dark"===a?"text-white":"text-gray-800"),children:"Bookings"}),0===n.length?(0,r.jsx)("p",{className:"".concat("dark"===a?"text-gray-400":"text-gray-500"),children:"No bookings found."}):(0,r.jsx)("div",{className:"overflow-x-auto rounded-lg border ".concat("dark"===a?"border-gray-600":"border-gray-200"),children:(0,r.jsxs)("table",{className:"min-w-full text-sm ".concat("dark"===a?"text-gray-300":"text-black"),children:[(0,r.jsx)("thead",{className:"dark"===a?"bg-gray-700":"bg-gray-100",children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("th",{className:"px-4 py-2 text-left font-medium ".concat("dark"===a?"text-white":"text-black"),children:"Guest ID"}),(0,r.jsx)("th",{className:"px-4 py-2 text-left font-medium ".concat("dark"===a?"text-white":"text-black"),children:"Room ID"}),(0,r.jsx)("th",{className:"px-4 py-2 text-left font-medium ".concat("dark"===a?"text-white":"text-black"),children:"Room Type"}),(0,r.jsx)("th",{className:"px-4 py-2 text-left font-medium ".concat("dark"===a?"text-white":"text-black"),children:"Check-in"}),(0,r.jsx)("th",{className:"px-4 py-2 text-left font-medium ".concat("dark"===a?"text-white":"text-black"),children:"Check-out"}),(0,r.jsx)("th",{className:"px-4 py-2 text-left font-medium ".concat("dark"===a?"text-white":"text-black"),children:"Action"})]})}),(0,r.jsx)("tbody",{className:"divide-y",children:n.map(e=>{var t;return(0,r.jsxs)("tr",{className:"dark"===a?"hover:bg-gray-700":"hover:bg-gray-50",children:[(0,r.jsx)("td",{className:"px-4 py-2 ".concat("dark"===a?"text-gray-300":"text-black"),children:e.userId}),(0,r.jsx)("td",{className:"px-4 py-2 ".concat("dark"===a?"text-gray-300":"text-black"),children:e.roomId}),(0,r.jsx)("td",{className:"px-4 py-2 ".concat("dark"===a?"text-gray-300":"text-black"),children:(null===(t=e.room)||void 0===t?void 0:t.type)||"N/A"}),(0,r.jsx)("td",{className:"px-4 py-2 ".concat("dark"===a?"text-gray-300":"text-black"),children:new Date(e.checkIn).toLocaleDateString()}),(0,r.jsx)("td",{className:"px-4 py-2 ".concat("dark"===a?"text-gray-300":"text-black"),children:new Date(e.checkOut).toLocaleDateString()}),(0,r.jsx)("td",{className:"px-4 py-2 ".concat("dark"===a?"text-gray-300":"text-black"),children:(0,r.jsx)("button",{onClick:()=>{var t;return j(e.id,null===(t=e.room)||void 0===t?void 0:t.type)},className:"px-3 py-1.5 rounded transition text-sm ".concat("dark"===a?"bg-red-600 hover:bg-red-700 text-white":"bg-red-500 hover:bg-red-600 text-white"),children:"Delete"})})]},e.id)})})]})})]}),g&&(0,r.jsx)("div",{className:"p-4 rounded-lg ".concat("dark"===a?"bg-red-900/50":"bg-red-100"),children:(0,r.jsx)("p",{className:"text-red-500",children:g})}),y&&(0,r.jsx)("div",{className:"p-4 rounded-lg ".concat("dark"===a?"bg-green-900/50":"bg-green-100"),children:(0,r.jsx)("p",{className:"text-green-500",children:y})}),(0,r.jsx)("button",{onClick:()=>t.back(),className:"mt-4 py-2 px-4 rounded-lg transition ".concat("dark"===a?"bg-gray-700 hover:bg-gray-600 text-white":"bg-gray-100 hover:bg-gray-200 text-blue-600"),children:"Go Back"})]})}},3903:(e,t,a)=>{Promise.resolve().then(a.bind(a,3395))},5550:(e,t,a)=>{"use strict";a.d(t,{D:()=>d,N:()=>l});var r=a(5155),s=a(2115);let c=(0,s.createContext)();function l(e){let{children:t}=e,[a,l]=(0,s.useState)("dark"),[d,n]=(0,s.useState)(!1);return((0,s.useEffect)(()=>{n(!0)},[]),d)?(0,r.jsx)(c.Provider,{value:{theme:a,toggleTheme:()=>{l("dark"===a?"light":"dark")}},children:t}):null}function d(){let e=(0,s.useContext)(c);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e}},9292:(e,t,a)=>{"use strict";a.d(t,{v$:()=>s}),a(8801),a(9980);var r=a(9509);async function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=await fetch(e,{...t,credentials:"include"});if(401===a.status||403===a.status){if(!await c())return new Response(JSON.stringify({message:"Session expired"}),{status:440,headers:{"Content-Type":"application/json"}});a=await fetch(e,{...t,credentials:"include"})}return a}r.env.ACCESS_SECRET,r.env.REFRESH_SECRET,r.env.ACCESS_TOKEN_EXPIRY,r.env.REFRESH_TOKEN_EXPIRY,parseInt(r.env.SALT_ROUNDS,10);async function c(){try{if(!(await fetch("/api/auth/refresh",{method:"POST",credentials:"include"})).ok)return!1;return!0}catch(e){return!1}}},9825:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[9268,3877,8441,1684,7358],()=>t(3903)),_N_E=e.O()}]);