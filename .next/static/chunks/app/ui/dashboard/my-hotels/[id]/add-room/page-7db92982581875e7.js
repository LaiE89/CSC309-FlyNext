(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5505],{534:(e,t,a)=>{Promise.resolve().then(a.bind(a,1484))},1484:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>o});var r=a(5155),s=a(2115),n=a(9292),i=a(5695),l=a(5550);function o(){let{id:e}=(0,i.useParams)(),t=(0,i.useRouter)(),{theme:a}=(0,l.D)(),[o,d]=(0,s.useState)("Double"),[c,u]=(0,s.useState)(!0),[g,m]=(0,s.useState)(100),[x,h]=(0,s.useState)(""),[p,b]=(0,s.useState)([]),[y,f]=(0,s.useState)([]),[v,k]=(0,s.useState)(!1),[j,w]=(0,s.useState)(""),[N,S]=(0,s.useState)(""),C=(e,t)=>{let a=e.target.files;a&&("images"===t?f([...y,...Array.from(a)]):setLogo(a[0]))},E=e=>{f(y.filter((t,a)=>a!==e))},R=e=>{b(p.filter((t,a)=>a!==e))},T=async a=>{a.preventDefault(),k(!0),w(""),S("");try{let a=[],r=[];for(let e of p)r.push(e);let s=await (0,n.v$)("/api/hotel-owner/my-hotels/".concat(e,"/add-room"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({type:o,available:c,pricePerNight:g,amenities:r,images:a})}),i=await s.json();if(!s.ok)throw 440===s.status&&t.push("/ui/error/session-expired"),Error(i.error);for(let r of y){let s=new FormData;s.append("file",r),s.append("upload-type","hotel-room-image"),s.append("hotel-id",e),s.append("room-id",i.room.id);let l=await (0,n.v$)("/api/upload",{method:"POST",credentials:"include",body:s}),o=await l.json();if(!l.ok)throw 440===l.status&&t.push("/ui/error/session-expired"),Error(o.error);a.push(o.url)}s=await (0,n.v$)("/api/hotel-owner/my-hotels/".concat(e,"/add-room"),{method:"PATCH",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({roomId:i.room.id,images:a})});let l=await s.json();if(!s.ok)throw 440===s.status&&t.push("/ui/error/session-expired"),Error(l.error);S("Room added successfully!"),d("Double"),u(!0),m(100),b([]),f([])}catch(e){w(e.message||"An unexpected error occurred.")}finally{k(!1)}};return(0,r.jsxs)("div",{className:"max-w-3xl mx-auto p-6 rounded-2xl shadow-lg space-y-6 ".concat("dark"===a?"bg-gray-800 text-white":"bg-white text-gray-800"),children:[(0,r.jsx)("h2",{className:"text-3xl font-bold ".concat("dark"===a?"text-white":"text-black"),children:"Add a New Room"}),(0,r.jsxs)("form",{onSubmit:T,className:"space-y-6",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1 ".concat("dark"===a?"text-gray-300":"text-gray-800"),children:"Room Type"}),(0,r.jsx)("input",{type:"text",value:o,onChange:e=>d(e.target.value),required:!0,className:"w-full border rounded-lg p-2 ".concat("dark"===a?"bg-gray-700 border-gray-600 text-white":"border-gray-300 text-black")})]}),(0,r.jsxs)("div",{className:"flex items-center gap-2",children:[(0,r.jsx)("input",{type:"checkbox",checked:c,onChange:e=>u(e.target.checked),id:"available",className:"h-4 w-4 rounded ".concat("dark"===a?"text-blue-400 border-gray-600":"text-blue-600 border-gray-300")}),(0,r.jsx)("label",{htmlFor:"available",className:"text-sm font-medium ".concat("dark"===a?"text-gray-300":"text-gray-800"),children:"Available"})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1 ".concat("dark"===a?"text-gray-300":"text-gray-800"),children:"Price Per Night"}),(0,r.jsx)("input",{type:"number",step:"0.01",value:g,onChange:e=>m(e.target.value),required:!0,className:"w-full border rounded-lg p-2 ".concat("dark"===a?"bg-gray-700 border-gray-600 text-white":"border-gray-300 text-black")})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium mb-1 ".concat("dark"===a?"text-gray-300":"text-gray-800"),children:"Amenities (Optional)"}),(0,r.jsxs)("div",{className:"flex gap-2",children:[(0,r.jsx)("input",{type:"text",value:x,onChange:e=>h(e.target.value),placeholder:"e.g., Wi-Fi, Air Conditioning",className:"flex-1 border rounded-lg p-2 ".concat("dark"===a?"bg-gray-700 border-gray-600 text-white":"border-gray-300 text-black")}),(0,r.jsx)("button",{onClick:()=>{""===x.trim()||p.includes(x)||(b([...p,x]),h(""))},type:"button",className:"px-4 py-2 rounded-lg transition ".concat("dark"===a?"bg-green-600 hover:bg-green-700 text-white":"bg-green-500 hover:bg-green-600 text-white"),children:"Add"})]}),p.length>0&&(0,r.jsx)("div",{className:"mt-2 space-y-1",children:p.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("p",{className:"text-sm ".concat("dark"===a?"text-gray-300":"text-gray-800"),children:e}),(0,r.jsx)("button",{type:"button",onClick:()=>R(t),className:"text-red-500 text-sm hover:underline",children:"Remove"})]},t))})]}),(0,r.jsxs)("div",{children:[(0,r.jsx)("label",{className:"block text-sm font-medium ".concat("dark"===a?"text-gray-300":"text-gray-800"),children:"Room Images (Optional)"}),(0,r.jsx)("input",{type:"file",accept:"image/*",multiple:!0,onChange:e=>C(e,"images"),className:"w-full p-2 border rounded ".concat("dark"===a?"bg-gray-700 border-gray-600 text-white":"border-gray-300 text-black")}),y.length>0&&(0,r.jsx)("div",{className:"mt-2 space-y-1",children:y.map((e,t)=>(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("p",{className:"text-sm truncate ".concat("dark"===a?"text-gray-300":"text-gray-800"),children:e.name}),(0,r.jsx)("button",{type:"button",onClick:()=>E(t),className:"text-red-500 text-sm hover:underline",children:"Remove"})]},t))})]}),j&&(0,r.jsx)("div",{className:"p-4 rounded-lg ".concat("dark"===a?"bg-red-900/50":"bg-red-100"),children:(0,r.jsx)("p",{className:"text-red-500",children:j})}),N&&(0,r.jsx)("div",{className:"p-4 rounded-lg ".concat("dark"===a?"bg-green-900/50":"bg-green-100"),children:(0,r.jsx)("p",{className:"text-green-500",children:N})}),(0,r.jsxs)("div",{className:"flex flex-wrap gap-3",children:[(0,r.jsx)("button",{type:"submit",disabled:v,className:"py-2 px-5 rounded-lg transition ".concat("dark"===a?"bg-blue-600 hover:bg-blue-700 text-white":"bg-blue-500 hover:bg-blue-600 text-white"),children:v?"Adding...":"Add Room"}),(0,r.jsx)("button",{type:"button",onClick:()=>t.back(),className:"py-2 px-5 rounded-lg transition ".concat("dark"===a?"bg-gray-600 hover:bg-gray-700 text-white":"bg-gray-500 hover:bg-gray-600 text-white"),children:"Cancel"})]})]})]})}},5550:(e,t,a)=>{"use strict";a.d(t,{D:()=>l,N:()=>i});var r=a(5155),s=a(2115);let n=(0,s.createContext)();function i(e){let{children:t}=e,[a,i]=(0,s.useState)("dark"),[l,o]=(0,s.useState)(!1);return((0,s.useEffect)(()=>{o(!0)},[]),l)?(0,r.jsx)(n.Provider,{value:{theme:a,toggleTheme:()=>{i("dark"===a?"light":"dark")}},children:t}):null}function l(){let e=(0,s.useContext)(n);if(void 0===e)throw Error("useTheme must be used within a ThemeProvider");return e}},9292:(e,t,a)=>{"use strict";a.d(t,{v$:()=>s}),a(8801),a(9980);var r=a(9509);async function s(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=await fetch(e,{...t,credentials:"include"});if(401===a.status||403===a.status){if(!await n())return new Response(JSON.stringify({message:"Session expired"}),{status:440,headers:{"Content-Type":"application/json"}});a=await fetch(e,{...t,credentials:"include"})}return a}r.env.ACCESS_SECRET,r.env.REFRESH_SECRET,r.env.ACCESS_TOKEN_EXPIRY,r.env.REFRESH_TOKEN_EXPIRY,parseInt(r.env.SALT_ROUNDS,10);async function n(){try{if(!(await fetch("/api/auth/refresh",{method:"POST",credentials:"include"})).ok)return!1;return!0}catch(e){return!1}}},9825:()=>{}},e=>{var t=t=>e(e.s=t);e.O(0,[9268,3877,8441,1684,7358],()=>t(534)),_N_E=e.O()}]);